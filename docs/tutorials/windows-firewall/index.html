<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/grapevine/blog/rss.xml" title="Grapevine Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/grapevine/blog/atom.xml" title="Grapevine Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-NY1EMEGC7C","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Opening the Windows Firewall | Grapevine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Opening the Windows Firewall | Grapevine"><meta data-react-helmet="true" name="description" content="If you&#x27;re running Windows, then in order for your server to be accessible from outside of your local machine you&#x27;ll need to open the Windows Firewall for your application. You can do this either from the Windows Defender UI or using code in your application. In both case, you will need elevated privledges (admin account) to make changes to the firewall."><meta data-react-helmet="true" property="og:description" content="If you&#x27;re running Windows, then in order for your server to be accessible from outside of your local machine you&#x27;ll need to open the Windows Firewall for your application. You can do this either from the Windows Defender UI or using code in your application. In both case, you will need elevated privledges (admin account) to make changes to the firewall."><meta data-react-helmet="true" property="og:url" content="https://scottoffen.github.io/grapevine/grapevine/docs/tutorials/windows-firewall"><link data-react-helmet="true" rel="shortcut icon" href="/grapevine/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scottoffen.github.io/grapevine/grapevine/docs/tutorials/windows-firewall"><link rel="stylesheet" href="/grapevine/styles.38194a08.css">
<link rel="preload" href="/grapevine/styles.1eb7275e.js" as="script">
<link rel="preload" href="/grapevine/runtime~main.353aa2e6.js" as="script">
<link rel="preload" href="/grapevine/main.18c8d343.js" as="script">
<link rel="preload" href="/grapevine/1.8d9a8567.js" as="script">
<link rel="preload" href="/grapevine/2.d7024c0b.js" as="script">
<link rel="preload" href="/grapevine/52.b1619523.js" as="script">
<link rel="preload" href="/grapevine/53.c5e17732.js" as="script">
<link rel="preload" href="/grapevine/f976f453.9b42769f.js" as="script">
<link rel="preload" href="/grapevine/17896441.c694a4a8.js" as="script">
<link rel="preload" href="/grapevine/54863ddd.659dbbfb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/grapevine/"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Grapevine</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/grapevine/docs/">Docs</a><a class="navbar__item navbar__link" href="/grapevine/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scottoffen/grapevine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/grapevine/"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Grapevine</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/grapevine/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/grapevine/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/scottoffen/grapevine" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Grapevine</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/routes">Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/route-scanner">Route Scanner</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/router">Router and Routing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/content-folders">Content Folders</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/rest-server">Rest Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/http-context">Http Context</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/locals">Using Locals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/middleware">Built In Middleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/config-and-start">Configuration and Startup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/http-status-codes">Http Status Codes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/http-methods">Http Methods</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/content-types-encoding">Content Types and Encoding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/advanced-access">Direct Access via Advanced</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/">FAQs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/send-response">Sending Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/add-middleware">Adding Middleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/parsing-multipart-form-data">Multipart Form Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/using-jwt">Using JWT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/using-https-ssl">Using HTTPS and SSL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/extending-grapevine">Extending Grapevine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/windows-authentication">Windows Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/tutorials/configure-namespace-reservation">Configure Namespace Reservation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/grapevine/docs/tutorials/windows-firewall">Windows Firewall</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Style Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/style-guide">Style Guide</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Opening the Windows Firewall</h1></header><div class="markdown"><p>If you&#x27;re running Windows, then in order for your server to be accessible from outside of your local machine you&#x27;ll need to open the Windows Firewall for your application. You can do this either from the Windows Defender UI or using code in your application. In both case, you will need elevated privledges (admin account) to make changes to the firewall.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="open-windows-firewall-via-ui"></a>Open Windows Firewall Via UI<a class="hash-link" href="#open-windows-firewall-via-ui" title="Direct link to heading">#</a></h2><p>These instructions are for Windows 10. For earlier versions of Windows, consult the documentation for specific steps.</p><ol><li><p>Open the <em>Windows Defender Firewall</em> Control Panel module by running <code>control firewall.cpl</code> from the command line.</p></li><li><p>On the left hand navigation, click on <strong>Allow an app or feature through Windows Defender Firewall</strong> to open the <em>Allowed Apps</em> dialog.</p></li></ol><p><img alt="img" src="/grapevine/assets/images/windows-defender-allowed-apps-aef9710368286123873d1a3ba357ebeb.png"></p><ol start="3"><li><p>Click on the <strong>Change settings</strong> button to allow the settings to be changed. If you are not logged in to an admin account, you will be prompted for admin credentials.</p></li><li><p>Click on <strong>Allow another app...</strong> button to open the <em>Add an app</em> dialog. Click the <strong>Browse</strong> button to browse to your applications executable file, and select it.</p></li></ol><p><img alt="img" src="/grapevine/assets/images/windows-defender-add-allowed-apps-22e8f5fbd449170224dd7f270f7672f7.png"></p><ol start="5"><li>Click on the <strong>Add</strong> button to add allow the application access through the firewall.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="open-windows-firewall-via-code"></a>Open Windows Firewall Via Code<a class="hash-link" href="#open-windows-firewall-via-code" title="Direct link to heading">#</a></h2><p>This requires accessing some COM references, which AFAIK can&#x27;t be done in a class library. But you can easily add it to your application using the example below.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="add-the-com-references"></a>Add The COM References<a class="hash-link" href="#add-the-com-references" title="Direct link to heading">#</a></h3><p>You will first want to add two COM references to your application, <code>hnetcfg.dll</code> and <code>FirewallAPI.dll</code>. Both DLLs are located in <code>C:\Windows\System32</code> directory.</p><ol><li><p>In Visual Studio, right click on your project dependencies and select <strong>Add COM Reference</strong>.</p></li><li><p>Click the <strong>Browse</strong> button in the lower right hand corner of the dialog box.</p></li><li><p>Navigate to <code>C:\Windows\System32</code> and select <code>hnetcfg.dll</code>, then clicke the <strong>Add</strong> button.</p></li><li><p>Repeat steps 2 and 3 for <code>FirewallAPI.dll</code>.</p></li><li><p>Click <strong>OK</strong> in the dialog box to return to Visual Studio.</p></li></ol><p><img alt="img" src="/grapevine/assets/images/add-com-references-93f0678b943a877a26395431afca5c7c.png"></p><p>The COM references should now be added to your project.</p><p><img alt="img" src="/grapevine/assets/images/show-com-references-973388ad58b2f9f83ede2afd4ddf15f4.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-a-firewallpolicy-class"></a>Create a FirewallPolicy Class<a class="hash-link" href="#create-a-firewallpolicy-class" title="Direct link to heading">#</a></h3><p>Next we&#x27;ll create a simple class that will create our firewall rule and policy. We&#x27;ll include methods with matching delegate signatures for our server starting and stopping event handlers to add and remove the rule from the policy.</p><div class="mdxCodeBlock_1zKU"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_2eSY">FirewallPolicy.cs</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using Grapevine;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using NetFwTypeLib;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Samples</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public class FirewallPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private INetFwRule _rule;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private INetFwPolicy2 _policy;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public string AppExecutablePath { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public string Description { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public string Name { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public INetFwPolicy2 Policy =&gt; _policy;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public INetFwRule Rule =&gt; _rule;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private INetFwRule GenerateRule()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (_policy == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                _policy = (INetFwPolicy2)Activator.CreateInstance(Type.GetTypeFromProgID(&quot;HNetCfg.FwPolicy2&quot;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule = (INetFwRule)Activator.CreateInstance(Type.GetTypeFromProgID(&quot;HNetCfg.FWRule&quot;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule.ApplicationName = AppExecutablePath;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule.Action = NET_FW_ACTION_.NET_FW_ACTION_ALLOW;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule.Description = Description;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule.Enabled = true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule.InterfaceTypes = &quot;All&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule.Name = Name;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return _rule;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public void AddFirewallPolicy(IRestServer server)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (_rule != null) return;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _policy.Rules.Add(GenerateRule());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public void RemoveFirewallPolicy(IRestServer server)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (_rule == null) return;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _policy.Rules.Remove(_rule.Name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _rule = null;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="add-middleware-extension-method"></a>Add Middleware Extension Method<a class="hash-link" href="#add-middleware-extension-method" title="Direct link to heading">#</a></h3><p>You can add a middleware extension to handle adding and removing your policy.</p><p>In the example here, I use the <code>IRestServer.AfterStarting</code> handler to add the policy because I don&#x27;t want the firewall to be open to receiving messages until the server has finished starting up.</p><p>Likewise, I use the <code>IRestServer.BeforeStopping</code> handler to remove the policy because I want to ensure no more requests are coming in before I begin shutting down the server.</p><div class="mdxCodeBlock_1zKU"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_2eSY">FirewallPolicyExtensions.cs</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using Grapevine;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Samples</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static class FirewallPolicyExtensions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public static IRestServer UseFirewallPolicy(this IRestServer server, FirewallPolicy policy)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            server.AfterStarting += policy.AddFirewallPolicy;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            server.BeforeStopping += policy.RemoveFirewallPolicy;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return server;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-your-middleware-extension"></a>Using Your Middleware Extension<a class="hash-link" href="#using-your-middleware-extension" title="Direct link to heading">#</a></h3><p>You can now add your firewall policy to the server - make sure to do this before starting the server.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var firewallPolicy = new FirewallPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    AppExecutablePath = &quot;&quot;, //Application Executable Path</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Description = &quot;Description of your firewall rule&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Name = &quot;&quot; // Your Application Name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">server.UseFirewallPolicy(firewallPolicy);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/scottoffen/grapevine-docs/edit/master/docs/tut-windows-firewall.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/grapevine/docs/tutorials/configure-namespace-reservation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Configure Namespace Reservation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/grapevine/docs/style-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Style Guide Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#open-windows-firewall-via-ui" class="table-of-contents__link">Open Windows Firewall Via UI</a></li><li><a href="#open-windows-firewall-via-code" class="table-of-contents__link">Open Windows Firewall Via Code</a><ul><li><a href="#add-the-com-references" class="table-of-contents__link">Add The COM References</a></li><li><a href="#create-a-firewallpolicy-class" class="table-of-contents__link">Create a FirewallPolicy Class</a></li><li><a href="#add-middleware-extension-method" class="table-of-contents__link">Add Middleware Extension Method</a></li><li><a href="#using-your-middleware-extension" class="table-of-contents__link">Using Your Middleware Extension</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/grapevine/docs/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/grapevine/docs/tutorials/">Tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/grapevine" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://github.com/scottoffen/grapevine/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/grapevine/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/scottoffen/grapevine" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Scott Offen</div></div></div></footer></div>
<script src="/grapevine/styles.1eb7275e.js"></script>
<script src="/grapevine/runtime~main.353aa2e6.js"></script>
<script src="/grapevine/main.18c8d343.js"></script>
<script src="/grapevine/1.8d9a8567.js"></script>
<script src="/grapevine/2.d7024c0b.js"></script>
<script src="/grapevine/52.b1619523.js"></script>
<script src="/grapevine/53.c5e17732.js"></script>
<script src="/grapevine/f976f453.9b42769f.js"></script>
<script src="/grapevine/17896441.c694a4a8.js"></script>
<script src="/grapevine/54863ddd.659dbbfb.js"></script>
</body>
</html>
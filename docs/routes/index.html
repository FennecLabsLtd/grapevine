<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/grapevine/blog/rss.xml" title="Grapevine Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/grapevine/blog/atom.xml" title="Grapevine Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-NY1EMEGC7C","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Routes | Grapevine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Routes | Grapevine"><meta data-react-helmet="true" name="description" content="A route (IRoute) represents the code you want to run and the conditions under which you want it to be run. Any method or function you want to execute must be asynchronous (returns a Task) and take a single parameter of type IHttpContext."><meta data-react-helmet="true" property="og:description" content="A route (IRoute) represents the code you want to run and the conditions under which you want it to be run. Any method or function you want to execute must be asynchronous (returns a Task) and take a single parameter of type IHttpContext."><meta data-react-helmet="true" property="og:url" content="https://scottoffen.github.io/grapevine/grapevine/docs/routes"><link data-react-helmet="true" rel="shortcut icon" href="/grapevine/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scottoffen.github.io/grapevine/grapevine/docs/routes"><link rel="stylesheet" href="/grapevine/styles.38194a08.css">
<link rel="preload" href="/grapevine/styles.1eb7275e.js" as="script">
<link rel="preload" href="/grapevine/runtime~main.353aa2e6.js" as="script">
<link rel="preload" href="/grapevine/main.18c8d343.js" as="script">
<link rel="preload" href="/grapevine/1.8d9a8567.js" as="script">
<link rel="preload" href="/grapevine/2.d7024c0b.js" as="script">
<link rel="preload" href="/grapevine/52.b1619523.js" as="script">
<link rel="preload" href="/grapevine/53.c5e17732.js" as="script">
<link rel="preload" href="/grapevine/f976f453.9b42769f.js" as="script">
<link rel="preload" href="/grapevine/17896441.c694a4a8.js" as="script">
<link rel="preload" href="/grapevine/c6b0d112.39abbe97.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/grapevine/"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Grapevine</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/grapevine/docs/">Docs</a><a class="navbar__item navbar__link" href="/grapevine/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scottoffen/grapevine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/grapevine/"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/grapevine/img/logo.png" alt="Grapevine Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Grapevine</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/grapevine/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/grapevine/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/scottoffen/grapevine" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Grapevine</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/">Overview</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/grapevine/docs/routes">Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/route-scanner">Route Scanner</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/router">Router and Routing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/content-folders">Content Folders</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/rest-server">Rest Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/http-context">Http Context</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/locals">Using Locals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/middleware">Built In Middleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/config-and-start">Configuration and Startup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/http-status-codes">Http Status Codes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/http-methods">Http Methods</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/content-types-encoding">Content Types and Encoding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/grapevine/docs/advanced-access">Direct Access via Advanced</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/">FAQs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/send-response">Sending Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/add-middleware">Adding Middleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/parsing-multipart-form-data">Multipart Form Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/using-jwt">Using JWT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/using-https-ssl">Using HTTPS and SSL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/extending-grapevine">Extending Grapevine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/windows-authentication">Windows Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/configure-namespace-reservation">Configure Namespace Reservation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/tutorials/windows-firewall">Windows Firewall</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Style Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/grapevine/docs/style-guide">Style Guide</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Routes</h1></header><div class="markdown"><p>A route (<code>IRoute</code>) represents the code you want to run and the conditions under which you want it to be run. Any method or function you want to execute must be asynchronous (returns a <code>Task</code>) and take a single parameter of type <a href="/grapevine/docs/http-context"><code>IHttpContext</code></a>.</p><p>A route requires only three things: The code to execute, and the HTTP verb (<a href="/grapevine/docs/http-methods"><code>HttpMethod</code></a>) and path info it should execute on. If you don&#x27;t specify a verb, the route will execute for any verbs with the specified path info. If you don&#x27;t specify the path info, the route will execute for any path info for the specified verb. If you don&#x27;t specify either the verb or the path info, this will create a sort of catch-all route, which may or may not be desireable.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="creating-a-route-from-a-lambda"></a>Creating A Route From A Lambda<a class="hash-link" href="#creating-a-route-from-a-lambda" title="Direct link to heading">#</a></h2><p>You can create a route from a lambda expression:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(async (ctx) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    await ctx.Response.SendResponseAsync(&quot;route from lambda expression&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, &quot;Get&quot;, &quot;/lambda&quot;));</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="creating-a-route-from-a-function"></a>Creating A Route From A Function<a class="hash-link" href="#creating-a-route-from-a-function" title="Direct link to heading">#</a></h2><p>You can generate a route using a <code>Func&lt;IHttpContext, Task&gt;</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Func&lt;IHttpContext, Task&gt; callback = async (ctx) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    await ctx.Response.SendResponseAsync(&quot;route from func&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Get&quot;, &quot;/function&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="creating-a-route-from-a-method"></a>Creating A Route From A Method<a class="hash-link" href="#creating-a-route-from-a-method" title="Direct link to heading">#</a></h2><p>Routes can be generated from both static and instance methods. Instance methods must be on a class that can be instantiated.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="instance-method"></a>Instance Method<a class="hash-link" href="#instance-method" title="Direct link to heading">#</a></h3><p>When using an instance method, we will generate a route with a generic parameter.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class TestResource</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public async Task TestRoute(IHttpContext context)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        await context.Response.SendResponseAsync(&quot;route from method&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var methodInfo = typeof(TestResource).GetMethod(&quot;TestRoute&quot;);</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">var route = new Route&lt;TestResource&gt;(methodInfo, &quot;Get&quot;, &quot;/instance-method&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>When registering a route that is generated from an instance method like this with the router, you will also need to add the class to the service collection.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">server.Router.Register(route);</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">server.Router.ServiceCollection.AddScoped&lt;TestResource&gt;();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="static-method"></a>Static Method<a class="hash-link" href="#static-method" title="Direct link to heading">#</a></h3><p>When generating a route from a static method, you treat it like you would a <code>Func&lt;IHttpContext, Task&gt;</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public static class StaticTestResource</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static async Task StaticTestRoute(IHttpContext context)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        await context.Response.SendResponseAsync(&quot;route from static method&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(StaticTestResource.StaticTestRoute, &quot;Get&quot;, &quot;/static-method&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="specifying-the-path-info"></a>Specifying the Path Info<a class="hash-link" href="#specifying-the-path-info" title="Direct link to heading">#</a></h2><p>The path info is extra path data that follows the prefix the request comes in on. There are a few different ways to specify the path info the routes shoudl respond to when creating a route.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="hard-coded-string"></a>Hard Coded String<a class="hash-link" href="#hard-coded-string" title="Direct link to heading">#</a></h3><p>This is the most straight forward. In the example below, this route will execute when the path info is <code>/some/path</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Any&quot;, &quot;/some/path&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="parameterized-string"></a>Parameterized String<a class="hash-link" href="#parameterized-string" title="Direct link to heading">#</a></h3><p>You can put parameters in the path info by enclosing them in curly braces.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Any&quot;, &quot;/users/{id}&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In this example, the route would respond to calls made to all of <code>/users/1234</code>, <code>/users/rudy</code> and <code>/users/1a2b3c</code>, but not to <code>/users</code> or <code>/users/1234/rudy</code>.</p><p>The id parameter specified in the route can be obtained from the request by key via the <code>IHttpContext.Request.PathParameters</code> property.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var id = context.Request.PathParameters[&quot;id&quot;];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can use multiple parameters in your string, and they do not need to be consecutive. The parameter names do need to be unique, or a runtime exception is thrown.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Any&quot;, &quot;/{resource}/list/{id}/gumbo&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Earlier versions of Grapevine used square brackets to denote parameters in the path info. This has been changed to curly braces in Grapevine 5 to match ASP.NET patterns.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="regular-expressions"></a>Regular Expressions<a class="hash-link" href="#regular-expressions" title="Direct link to heading">#</a></h3><p>You can express the path info pattern as a regular expression string or as a <code>Regex</code> instance. <strong>If the path info string begins with a caret (<code>^</code>), the string will be treated as a regular expression.</strong> Regular expressions can be useful when the value needs to match a specific pattern (e.g. the user id is between 3 and 5 digits long).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var expr = @&quot;^/users/(/d{3,5})&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route1 = new Route(callback, &quot;Any&quot;, expr);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route2 = new Route(callback, &quot;Any&quot;, new Regex(expr));</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Capture groups specified in the regular expression can be accessed in the same way as named parameters in parameterized strings, but the key will instead be the numbered capture group preceeded by a lower-case <code>p</code>. In the exampel above, the id would be referenced as <code>IHttpContext.Request.PathParameters[&quot;p0&quot;]</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="route-specific-path-parameters"></a>Route Specific Path Parameters<a class="hash-link" href="#route-specific-path-parameters" title="Direct link to heading">#</a></h3><p>If multiple routes are executed, but have different named (or unnamed) path parameters, they will be named and accessed based on how the route was defined. The following example uses <a href="/grapevine/docs/locals">locals</a> to demonstrate. Notice how in each callback the route parameters are referenced using different names, but the same values are assigned to them.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Func&lt;IHttpContext, Task&gt; callbackA = async (ctx) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!context.Contains(&quot;PathParameters&quot;)) context.Set(&quot;PathParameters&quot;, new StringBuilder());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var sb = context.GetAs&lt;StringBuilder&gt;(&quot;PathParameters&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;A: Count: {context.Request.PathParameters.Count}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;\tkey: {context.Request.PathParameters[&quot;key&quot;]}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;\tvalue: {context.Request.PathParameters[&quot;value&quot;]}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    await Task.CompletedTask;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Func&lt;IHttpContext, Task&gt; callbackB = async (ctx) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!context.Contains(&quot;PathParameters&quot;)) context.Set(&quot;PathParameters&quot;, new StringBuilder());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var sb = context.GetAs&lt;StringBuilder&gt;(&quot;PathParameters&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;B: Count: {context.Request.PathParameters.Count}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;\tp0: {context.Request.PathParameters[&quot;p0&quot;]}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;\tp1: {context.Request.PathParameters[&quot;p1&quot;]}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    await Task.CompletedTask;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Func&lt;IHttpContext, Task&gt; callbackC = async (ctx) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!context.Contains(&quot;PathParameters&quot;)) context.Set(&quot;PathParameters&quot;, new StringBuilder());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var sb = context.GetAs&lt;StringBuilder&gt;(&quot;PathParameters&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;C: Count: {context.Request.PathParameters.Count}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;\tthing1: {context.Request.PathParameters[&quot;thing1&quot;]}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sb.Append($&quot;\tthing2: {context.Request.PathParameters[&quot;thing2&quot;]}{Environment.NewLine}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    await context.Response.SendResponseAsync(sb.ToString());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var routeA = new Route(callbackA, &quot;Get&quot;, &quot;/api/test/{key}/{value}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var routeB = new Route(callbackB, &quot;Get&quot;, new Regex(@&quot;^/api/test/([a-zA-Z]+)/(\d{1,})&quot;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var routeC = new Route(callbackC, &quot;Get&quot;, &quot;/api/test/{thing1}/{thing2}&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>When those three routes are registered in order and you go to the url <code>http://localhost:1234/api/test/abc/123</code>, the output will look like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">A: Count: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    key: abc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    value: 123</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">B: Count: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p0: abc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p1: 123</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C: Count: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    thing1: abc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    thing2: 123</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><blockquote><p>The path info when passed as a string is ultimately translated into a regular expression.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="specifying-the-http-verb"></a>Specifying the Http Verb<a class="hash-link" href="#specifying-the-http-verb" title="Direct link to heading">#</a></h2><p>The helper class <code>HttpMethod</code> can be used to specify the verb for matching routes. It contains a number of static properties the ensure consistency.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, HttpMethod.Get, &quot;/some/path&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In order to avoid ambiguity between <code>Grapevine.HttpMethod</code> and <code>System.Net.Http.HttpMethod</code>, you can also use a string to specify the method.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Get&quot;, &quot;/some/path&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="limit-route-matching-using-headers"></a>Limit Route Matching Using Headers<a class="hash-link" href="#limit-route-matching-using-headers" title="Direct link to heading">#</a></h2><p>You can also further limit whether a route is matched to a request based on the value of any header.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Get&quot;, &quot;/some/path&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .WithHeader(&quot;Host&quot;, new Regex(@&quot;^localhost:1234$&quot;));</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This method is chainable, so you can add as many header conditions as needed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enable-and-disable-routes"></a>Enable And Disable Routes<a class="hash-link" href="#enable-and-disable-routes" title="Direct link to heading">#</a></h2><p>Routes can be enabled and disabled. Only enabled routes will be matched by the router, and only enabled routes will be invoked.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = new Route(callback, &quot;Get&quot;, &quot;/some/path&quot;, false)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .Enable()   // extension method</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .Disable(); // extension method</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Direct property access</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">route.Enabled = true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="route-name-and-description"></a>Route Name and Description<a class="hash-link" href="#route-name-and-description" title="Direct link to heading">#</a></h2><p>The <code>Name</code> and <code>Description</code> properties are primarily used in output when debugging and logging. You can change them at any time. You can also use the <code>Name</code> property to retrieve a route from the routers routing table. While uniquness is not required, in this last case, it will be helpful if your route names are unique.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var route = server.Router.RoutingTable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .Where(r =&gt; r.Name == &quot;Some Unique Name&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .FirstOrDefault();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/scottoffen/grapevine-docs/edit/master/docs/gv-routes.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/grapevine/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/grapevine/docs/route-scanner"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Route Scanner Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-a-route-from-a-lambda" class="table-of-contents__link">Creating A Route From A Lambda</a></li><li><a href="#creating-a-route-from-a-function" class="table-of-contents__link">Creating A Route From A Function</a></li><li><a href="#creating-a-route-from-a-method" class="table-of-contents__link">Creating A Route From A Method</a><ul><li><a href="#instance-method" class="table-of-contents__link">Instance Method</a></li><li><a href="#static-method" class="table-of-contents__link">Static Method</a></li></ul></li><li><a href="#specifying-the-path-info" class="table-of-contents__link">Specifying the Path Info</a><ul><li><a href="#hard-coded-string" class="table-of-contents__link">Hard Coded String</a></li><li><a href="#parameterized-string" class="table-of-contents__link">Parameterized String</a></li><li><a href="#regular-expressions" class="table-of-contents__link">Regular Expressions</a></li><li><a href="#route-specific-path-parameters" class="table-of-contents__link">Route Specific Path Parameters</a></li></ul></li><li><a href="#specifying-the-http-verb" class="table-of-contents__link">Specifying the Http Verb</a></li><li><a href="#limit-route-matching-using-headers" class="table-of-contents__link">Limit Route Matching Using Headers</a></li><li><a href="#enable-and-disable-routes" class="table-of-contents__link">Enable And Disable Routes</a></li><li><a href="#route-name-and-description" class="table-of-contents__link">Route Name and Description</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/grapevine/docs/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/grapevine/docs/tutorials/">Tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/grapevine" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://github.com/scottoffen/grapevine/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/grapevine/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/scottoffen/grapevine" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Scott Offen</div></div></div></footer></div>
<script src="/grapevine/styles.1eb7275e.js"></script>
<script src="/grapevine/runtime~main.353aa2e6.js"></script>
<script src="/grapevine/main.18c8d343.js"></script>
<script src="/grapevine/1.8d9a8567.js"></script>
<script src="/grapevine/2.d7024c0b.js"></script>
<script src="/grapevine/52.b1619523.js"></script>
<script src="/grapevine/53.c5e17732.js"></script>
<script src="/grapevine/f976f453.9b42769f.js"></script>
<script src="/grapevine/17896441.c694a4a8.js"></script>
<script src="/grapevine/c6b0d112.39abbe97.js"></script>
</body>
</html>